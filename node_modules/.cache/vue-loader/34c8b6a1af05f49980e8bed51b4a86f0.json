{"remainingRequest":"E:\\article_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\article_vue\\src\\components\\CropperImage.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\article_vue\\src\\components\\CropperImage.vue","mtime":1619054236014},{"path":"E:\\article_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\article_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\article_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\article_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgVnVlQ3JvcHBlciBmcm9tICd2dWUtY3JvcHBlcicNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIkNyb3BwZXJJbWFnZSIsDQogIGNvbXBvbmVudHM6IHsNCiAgICBWdWVDcm9wcGVyDQogIH0sDQogIHByb3BzOlsnTmFtZSddLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBuYW1lOnRoaXMuTmFtZSwNCiAgICAgIHByZXZpZXdzOiB7fSwNCiAgICAgIG9wdGlvbjp7DQogICAgICAgIGltZzogJycsICAgICAgICAgICAgIC8v6KOB5Ymq5Zu+54mH55qE5Zyw5Z2ADQogICAgICAgIG91dHB1dFNpemU6IDEsICAgICAgIC8v6KOB5Ymq55Sf5oiQ5Zu+54mH55qE6LSo6YePKOWPr+mAiTAuMSAtIDEpDQogICAgICAgIG91dHB1dFR5cGU6ICdqcGVnJywgIC8v6KOB5Ymq55Sf5oiQ5Zu+54mH55qE5qC85byP77yIanBlZyB8fCBwbmcgfHwgd2VicO+8iQ0KICAgICAgICBpbmZvOiB0cnVlLCAgICAgICAgICAvL+WbvueJh+Wkp+Wwj+S/oeaBrw0KICAgICAgICBjYW5TY2FsZTogdHJ1ZSwgICAgICAvL+WbvueJh+aYr+WQpuWFgeiuuOa7mui9rue8qeaUvg0KICAgICAgICBhdXRvQ3JvcDogdHJ1ZSwgICAgICAvL+aYr+WQpum7mOiupOeUn+aIkOaIquWbvuahhg0KICAgICAgICBhdXRvQ3JvcFdpZHRoOiAyMzAsICAvL+m7mOiupOeUn+aIkOaIquWbvuahhuWuveW6pg0KICAgICAgICBhdXRvQ3JvcEhlaWdodDogMTUwLCAvL+m7mOiupOeUn+aIkOaIquWbvuahhumrmOW6pg0KICAgICAgICBmaXhlZDogdHJ1ZSwgICAgICAgICAvL+aYr+WQpuW8gOWQr+aIquWbvuahhuWuvemrmOWbuuWumuavlOS+iw0KICAgICAgICBmaXhlZE51bWJlcjogWzEuNTMsIDFdLCAvL+aIquWbvuahhueahOWuvemrmOavlOS+iw0KICAgICAgICBmdWxsOiBmYWxzZSwgICAgICAgICAvL2ZhbHNl5oyJ5Y6f5q+U5L6L6KOB5YiH5Zu+54mH77yM5LiN5aSx55yfDQogICAgICAgIGZpeGVkQm94OiB0cnVlLCAgICAgIC8v5Zu65a6a5oiq5Zu+5qGG5aSn5bCP77yM5LiN5YWB6K645pS55Y+YDQogICAgICAgIGNhbk1vdmU6IGZhbHNlLCAgICAgIC8v5LiK5Lyg5Zu+54mH5piv5ZCm5Y+v5Lul56e75YqoDQogICAgICAgIGNhbk1vdmVCb3g6IHRydWUsICAgIC8v5oiq5Zu+5qGG6IO95ZCm5ouW5YqoDQogICAgICAgIG9yaWdpbmFsOiBmYWxzZSwgICAgIC8v5LiK5Lyg5Zu+54mH5oyJ54Wn5Y6f5aeL5q+U5L6L5riy5p+TDQogICAgICAgIGNlbnRlckJveDogZmFsc2UsICAgIC8v5oiq5Zu+5qGG5piv5ZCm6KKr6ZmQ5Yi25Zyo5Zu+54mH6YeM6Z2iDQogICAgICAgIGhlaWdodDogdHJ1ZSwgICAgICAgIC8v5piv5ZCm5oyJ54Wn6K6+5aSH55qEZHByIOi+k+WHuuetieavlOS+i+WbvueJhw0KICAgICAgICBpbmZvVHJ1ZTogZmFsc2UsICAgICAvL3RydWXkuLrlsZXnpLrnnJ/lrp7ovpPlh7rlm77niYflrr3pq5jvvIxmYWxzZeWxleekuueci+WIsOeahOaIquWbvuahhuWuvemrmA0KICAgICAgICBtYXhJbWdTaXplOiAzMDAwLCAgICAvL+mZkOWItuWbvueJh+acgOWkp+WuveW6puWSjOmrmOW6pg0KICAgICAgICBlbmxhcmdlOiAxLCAgICAgICAgICAvL+WbvueJh+agueaNruaIquWbvuahhui+k+WHuuavlOS+i+WAjeaVsA0KICAgICAgICBtb2RlOiAnMjMwcHggMTUwcHgnICAvL+WbvueJh+m7mOiupOa4suafk+aWueW8jw0KICAgICAgfQ0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvL+WIneWni+WMluWHveaVsA0KICAgIGltZ0xvYWQgKG1zZykgew0KICAgICAgY29uc29sZS5sb2coIuW3peWFt+WIneWni+WMluWHveaVsD09PT09Iittc2cpDQogICAgfSwNCiAgICAvL+WbvueJh+e8qeaUvg0KICAgIGNoYW5nZVNjYWxlIChudW0pIHsNCiAgICAgIG51bSA9IG51bSB8fCAxDQogICAgICB0aGlzLiRyZWZzLmNyb3BwZXIuY2hhbmdlU2NhbGUobnVtKQ0KICAgIH0sDQogICAgLy/lkJHlt6bml4vovawNCiAgICByb3RhdGVMZWZ0ICgpIHsNCiAgICAgIHRoaXMuJHJlZnMuY3JvcHBlci5yb3RhdGVMZWZ0KCkNCiAgICB9LA0KICAgIC8v5ZCR5Y+z5peL6L2sDQogICAgcm90YXRlUmlnaHQgKCkgew0KICAgICAgdGhpcy4kcmVmcy5jcm9wcGVyLnJvdGF0ZVJpZ2h0KCkNCiAgICB9LA0KICAgIC8v5a6e5pe26aKE6KeI5Ye95pWwDQogICAgcmVhbFRpbWUgKGRhdGEpIHsNCiAgICAgIHRoaXMucHJldmlld3MgPSBkYXRhDQogICAgfSwNCiAgICAvL+mAieaLqeWbvueJhw0KICAgIHNlbGVjdEltZyAoZSkgew0KICAgICAgbGV0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXQ0KICAgICAgaWYgKCEvXC4oanBnfGpwZWd8cG5nfEpQR3xQTkcpJC8udGVzdChlLnRhcmdldC52YWx1ZSkpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgbWVzc2FnZTogJ+WbvueJh+exu+Wei+imgeaxgu+8mmpwZWfjgIFqcGfjgIFwbmcnLA0KICAgICAgICAgIHR5cGU6ICJlcnJvciINCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgfQ0KICAgICAgLy/ovazljJbkuLpibG9iDQogICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKQ0KICAgICAgcmVhZGVyLm9ubG9hZCA9IChlKSA9PiB7DQogICAgICAgIGxldCBkYXRhDQogICAgICAgIGlmICh0eXBlb2YgZS50YXJnZXQucmVzdWx0ID09PSAnb2JqZWN0Jykgew0KICAgICAgICAgIGRhdGEgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbZS50YXJnZXQucmVzdWx0XSkpDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgZGF0YSA9IGUudGFyZ2V0LnJlc3VsdA0KICAgICAgICB9DQogICAgICAgIHRoaXMub3B0aW9uLmltZyA9IGRhdGENCiAgICAgIH0NCiAgICAgIC8v6L2s5YyW5Li6YmFzZTY0DQogICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKQ0KICAgIH0sDQogICAgLy/kuIrkvKDlm77niYcNCiAgICB1cGxvYWRJbWcgKHR5cGUpIHsNCiAgICAgIGxldCBfdGhpcyA9IHRoaXM7DQogICAgICBpZiAodHlwZSA9PT0gJ2Jsb2InKSB7DQogICAgICAgIC8v6I635Y+W5oiq5Zu+55qEYmxvYuaVsOaNrg0KICAgICAgICB0aGlzLiRyZWZzLmNyb3BwZXIuZ2V0Q3JvcEJsb2IoYXN5bmMgKGRhdGEpID0+IHsNCiAgICAgICAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsNCiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLGRhdGEsIkRYLmpwZyIpDQogICAgICAgICAgLy/osIPnlKhheGlvc+S4iuS8oA0KICAgICAgICAgIGxldCB7ZGF0YTogcmVzfSA9IGF3YWl0IF90aGlzLiRodHRwLnBvc3QoJy9hcGkvZmlsZS9pbWdVcGxvYWQnLCBmb3JtRGF0YSkNCiAgICAgICAgICBpZihyZXMuY29kZSA9PT0gMjAwKXsNCiAgICAgICAgICAgIF90aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgbWVzc2FnZTogcmVzLm1zZywNCiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGxldCBkYXRhID0gcmVzLmRhdGEucmVwbGFjZSgnWycsJycpLnJlcGxhY2UoJ10nLCcnKS5zcGxpdCgnLCcpOw0KICAgICAgICAgICAgbGV0IGltZ0luZm8gPSB7DQogICAgICAgICAgICAgIG5hbWUgOiBfdGhpcy5OYW1lLA0KICAgICAgICAgICAgICB1cmwgOiBkYXRhWzBdDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgX3RoaXMuJGVtaXQoJ3VwbG9hZEltZ1N1Y2Nlc3MnLGltZ0luZm8pOw0KICAgICAgICAgIH1lbHNlIHsNCiAgICAgICAgICAgIF90aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+aWh+S7tuacjeWKoeW8guW4uO+8jOivt+iBlOezu+euoeeQhuWRmO+8gScsDQogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciINCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KfQ0K"},{"version":3,"sources":["CropperImage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CropperImage.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"cropper-content\">\r\n    <div class=\"cropper-box\">\r\n      <div class=\"cropper\">\r\n        <vue-cropper\r\n            ref=\"cropper\"\r\n            :img=\"option.img\"\r\n            :outputSize=\"option.outputSize\"\r\n            :outputType=\"option.outputType\"\r\n            :info=\"option.info\"\r\n            :canScale=\"option.canScale\"\r\n            :autoCrop=\"option.autoCrop\"\r\n            :autoCropWidth=\"option.autoCropWidth\"\r\n            :autoCropHeight=\"option.autoCropHeight\"\r\n            :fixed=\"option.fixed\"\r\n            :fixedNumber=\"option.fixedNumber\"\r\n            :full=\"option.full\"\r\n            :fixedBox=\"option.fixedBox\"\r\n            :canMove=\"option.canMove\"\r\n            :canMoveBox=\"option.canMoveBox\"\r\n            :original=\"option.original\"\r\n            :centerBox=\"option.centerBox\"\r\n            :height=\"option.height\"\r\n            :infoTrue=\"option.infoTrue\"\r\n            :maxImgSize=\"option.maxImgSize\"\r\n            :enlarge=\"option.enlarge\"\r\n            :mode=\"option.mode\"\r\n            @realTime=\"realTime\"\r\n            @imgLoad=\"imgLoad\">\r\n        </vue-cropper>\r\n      </div>\r\n      <!--底部操作工具按钮-->\r\n      <div class=\"footer-btn\">\r\n        <div class=\"scope-btn\">\r\n          <label class=\"btn\" for=\"uploads\">选择封面</label>\r\n          <input type=\"file\" id=\"uploads\" style=\"position:absolute; clip:rect(0 0 0 0);\" accept=\"image/png, image/jpeg, image/gif, image/jpg\" @change=\"selectImg($event)\">\r\n          <el-button size=\"mini\" type=\"danger\" plain icon=\"el-icon-zoom-in\" @click=\"changeScale(1)\">放大</el-button>\r\n          <el-button size=\"mini\" type=\"danger\" plain icon=\"el-icon-zoom-out\" @click=\"changeScale(-1)\">缩小</el-button>\r\n          <el-button size=\"mini\" type=\"danger\" plain @click=\"rotateLeft\">↺ 左旋转</el-button>\r\n          <el-button size=\"mini\" type=\"danger\" plain @click=\"rotateRight\">↻ 右旋转</el-button>\r\n        </div>\r\n        <div class=\"upload-btn\">\r\n          <el-button size=\"mini\" type=\"success\" @click=\"uploadImg('blob')\">上传封面 <i class=\"el-icon-upload\"></i></el-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!--预览效果图-->\r\n    <div class=\"show-preview\">\r\n      <div :style=\"previews.div\" class=\"preview\">\r\n        <img :src=\"previews.url\" :style=\"previews.img\">\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport VueCropper from 'vue-cropper'\r\nexport default {\r\n  name: \"CropperImage\",\r\n  components: {\r\n    VueCropper\r\n  },\r\n  props:['Name'],\r\n  data() {\r\n    return {\r\n      name:this.Name,\r\n      previews: {},\r\n      option:{\r\n        img: '',             //裁剪图片的地址\r\n        outputSize: 1,       //裁剪生成图片的质量(可选0.1 - 1)\r\n        outputType: 'jpeg',  //裁剪生成图片的格式（jpeg || png || webp）\r\n        info: true,          //图片大小信息\r\n        canScale: true,      //图片是否允许滚轮缩放\r\n        autoCrop: true,      //是否默认生成截图框\r\n        autoCropWidth: 230,  //默认生成截图框宽度\r\n        autoCropHeight: 150, //默认生成截图框高度\r\n        fixed: true,         //是否开启截图框宽高固定比例\r\n        fixedNumber: [1.53, 1], //截图框的宽高比例\r\n        full: false,         //false按原比例裁切图片，不失真\r\n        fixedBox: true,      //固定截图框大小，不允许改变\r\n        canMove: false,      //上传图片是否可以移动\r\n        canMoveBox: true,    //截图框能否拖动\r\n        original: false,     //上传图片按照原始比例渲染\r\n        centerBox: false,    //截图框是否被限制在图片里面\r\n        height: true,        //是否按照设备的dpr 输出等比例图片\r\n        infoTrue: false,     //true为展示真实输出图片宽高，false展示看到的截图框宽高\r\n        maxImgSize: 3000,    //限制图片最大宽度和高度\r\n        enlarge: 1,          //图片根据截图框输出比例倍数\r\n        mode: '230px 150px'  //图片默认渲染方式\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    //初始化函数\r\n    imgLoad (msg) {\r\n      console.log(\"工具初始化函数=====\"+msg)\r\n    },\r\n    //图片缩放\r\n    changeScale (num) {\r\n      num = num || 1\r\n      this.$refs.cropper.changeScale(num)\r\n    },\r\n    //向左旋转\r\n    rotateLeft () {\r\n      this.$refs.cropper.rotateLeft()\r\n    },\r\n    //向右旋转\r\n    rotateRight () {\r\n      this.$refs.cropper.rotateRight()\r\n    },\r\n    //实时预览函数\r\n    realTime (data) {\r\n      this.previews = data\r\n    },\r\n    //选择图片\r\n    selectImg (e) {\r\n      let file = e.target.files[0]\r\n      if (!/\\.(jpg|jpeg|png|JPG|PNG)$/.test(e.target.value)) {\r\n        this.$message({\r\n          message: '图片类型要求：jpeg、jpg、png',\r\n          type: \"error\"\r\n        });\r\n        return false\r\n      }\r\n      //转化为blob\r\n      let reader = new FileReader()\r\n      reader.onload = (e) => {\r\n        let data\r\n        if (typeof e.target.result === 'object') {\r\n          data = window.URL.createObjectURL(new Blob([e.target.result]))\r\n        } else {\r\n          data = e.target.result\r\n        }\r\n        this.option.img = data\r\n      }\r\n      //转化为base64\r\n      reader.readAsDataURL(file)\r\n    },\r\n    //上传图片\r\n    uploadImg (type) {\r\n      let _this = this;\r\n      if (type === 'blob') {\r\n        //获取截图的blob数据\r\n        this.$refs.cropper.getCropBlob(async (data) => {\r\n          let formData = new FormData();\r\n          formData.append('file',data,\"DX.jpg\")\r\n          //调用axios上传\r\n          let {data: res} = await _this.$http.post('/api/file/imgUpload', formData)\r\n          if(res.code === 200){\r\n            _this.$message({\r\n              message: res.msg,\r\n              type: \"success\"\r\n            });\r\n            let data = res.data.replace('[','').replace(']','').split(',');\r\n            let imgInfo = {\r\n              name : _this.Name,\r\n              url : data[0]\r\n            };\r\n            _this.$emit('uploadImgSuccess',imgInfo);\r\n          }else {\r\n            _this.$message({\r\n              message: '文件服务异常，请联系管理员！',\r\n              type: \"error\"\r\n            });\r\n          }\r\n        })\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.cropper-content{\r\n  display: flex;\r\n  display: -webkit-flex;\r\n  justify-content: flex-end;\r\n  .cropper-box{\r\n    flex: 1;\r\n    width: 100%;\r\n    .cropper{\r\n      width: auto;\r\n      height: 300px;\r\n    }\r\n  }\r\n\r\n  .show-preview{\r\n    flex: 1;\r\n    -webkit-flex: 1;\r\n    display: flex;\r\n    display: -webkit-flex;\r\n    justify-content: center;\r\n    .preview{\r\n      overflow: hidden;\r\n      border:1px solid #67c23a;\r\n      background: #cccccc;\r\n    }\r\n  }\r\n}\r\n.footer-btn{\r\n  margin-top: 30px;\r\n  display: flex;\r\n  display: -webkit-flex;\r\n  justify-content: flex-end;\r\n  .scope-btn{\r\n    display: flex;\r\n    display: -webkit-flex;\r\n    justify-content: space-between;\r\n    padding-right: 10px;\r\n  }\r\n  .upload-btn{\r\n    flex: 1;\r\n    -webkit-flex: 1;\r\n    display: flex;\r\n    display: -webkit-flex;\r\n    justify-content: center;\r\n  }\r\n  .btn {\r\n    outline: none;\r\n    display: inline-block;\r\n    line-height: 1;\r\n    white-space: nowrap;\r\n    cursor: pointer;\r\n    -webkit-appearance: none;\r\n    text-align: center;\r\n    -webkit-box-sizing: border-box;\r\n    box-sizing: border-box;\r\n    outline: 0;\r\n    -webkit-transition: .1s;\r\n    transition: .1s;\r\n    font-weight: 500;\r\n    padding: 8px 15px;\r\n    font-size: 12px;\r\n    border-radius: 3px;\r\n    color: #fff;\r\n    background-color: #409EFF;\r\n    border-color: #409EFF;\r\n    margin-right: 10px;\r\n  }\r\n}\r\n</style>\r\n\r\n"]}]}